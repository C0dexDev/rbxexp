local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

local localPlayer = Players.LocalPlayer
local char = localPlayer.Character or localPlayer.CharacterAdded:Wait()
local root = char:WaitForChild("HumanoidRootPart") -- usar RootPart es m√°s estable
local destPos = Vector3.new(-6011, 1, 4281)

local finish = false

-- Funci√≥n para buscar el jugador m√°s cercano en rango
local function GetNearestPlayer()
	local nearestPlayer = nil
	local nearestDist = math.huge

	for _, p in Players:GetPlayers() do
		if p ~= localPlayer and p.Character and p.Character.PrimaryPart then
			local pChar = p.Character
			local charDistance = (root.Position - pChar.PrimaryPart.Position).Magnitude
			local destDistance = (pChar.PrimaryPart.Position - destPos).Magnitude

			if destDistance <= 500 and charDistance < nearestDist then
				nearestPlayer = p
				nearestDist = charDistance
			end
		end
	end

	return nearestPlayer
end

-- Teletransporte constante mientras busca
task.spawn(function()
	while task.wait() do
		if finish then break end
		root.CFrame = CFrame.new(destPos + Vector3.new(0,5,0))
	end
end)

-- Esperar medio segundo antes de buscar
task.wait(0.5)

print("VICTIMSEARCH1")
local victim
repeat
	victim = GetNearestPlayer()
	task.wait(0.2)
	print("VICTIMSEARCH")
until victim

print("FINISH")
finish = true

local targetChar = victim.Character or victim.CharacterAdded:Wait()
local targetHum = targetChar:FindFirstChildOfClass("Humanoid")
local ragdollPart = targetChar:FindFirstChild("RagdollColliderParts") 
	and targetChar.RagdollColliderParts:FindFirstChildWhichIsA("BasePart")

if targetHum and ragdollPart then
	print("POUNCE")
	local pounceEvent = ReplicatedStorage:WaitForChild("SpecialAttackRemoteEvent_PounceAttack")
	pounceEvent:FireServer(targetHum, ragdollPart)

	repeat
		pounceEvent:FireServer(targetHum, ragdollPart)
		task.wait()
		print("POUNCE")
	until (root.Position - targetChar.PrimaryPart.Position).Magnitude <= 10

	-- üî• Repetir "Cancel" durante 10 segundos
	local startTime = tick()
	while tick() - startTime < 10 do
		pounceEvent:FireServer("Cancel")
		task.wait(0.5) -- manda cancel cada 0.5 segundos
	end
end
